<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
  <!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="UTF-8">
<title>Auto ‚Äì Pohyb silnice + restart</title>

<style>
<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="UTF-8">
<title>Auto ‚Äì checkpointy</title>
<style>
body {
    margin: 0;
    background: black;
}
canvas {
    display: block;
    margin: auto;
    background: #333;
}
</style>
</head>
<body>

<canvas id="game" width="800" height="500"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

let carX, carY, speed;
let curve, targetCurve, scroll;
let gameOver;
let distance;

const roadWidth = 300;
const SPEED_MULTIPLIER = 20;
const keys = {};

// üëá CHECKPOINTY (v metrech)
const checkpoints = [12000, 20000, 30000, 40000];
let currentCheckpoint = 0;
let checkpointVisible = false;

// ===== RESET =====
function resetGame() {
    carX = canvas.width / 2;
    carY = canvas.height - 80;
    speed = 0;
    curve = 0;
    targetCurve = 0;
    scroll = 0;
    distance = 0;
    gameOver = false;
    currentCheckpoint = 0;
    checkpointVisible = false;
}

// ===== OVL√ÅD√ÅN√ç =====
document.addEventListener("keydown", e => {
    const k = e.key.toLowerCase();
    keys[k] = true;
    if (k === "r" && gameOver) resetGame();
});
document.addEventListener("keyup", e => keys[e.key.toLowerCase()] = false);

// ===== LOGIKA =====
function update() {
    if (gameOver) return;

    if (keys["w"]) speed += 0.12;
    if (keys["s"]) speed -= 0.15;
    if (keys["a"]) carX -= 4;
    if (keys["d"]) carX += 4;

    speed = Math.max(0, Math.min(8, speed));
    scroll += speed * 4;
    distance += speed;

    // n√°hodn√© zat√°ƒçky
    if (Math.random() < 0.01) {
        targetCurve = (Math.random() - 0.5) * 2;
    }
    curve += (targetCurve - curve) * 0.01;

    // silnice
    const roadCenter = canvas.width / 2 + curve * 160;

    if (
        carX < roadCenter - roadWidth / 2 ||
        carX > roadCenter + roadWidth / 2
    ) {
        gameOver = true;
    }

    // CHECKPOINT LOGIKA
    if (
        currentCheckpoint < checkpoints.length &&
        distance >= checkpoints[currentCheckpoint] - 100
    ) {
        checkpointVisible = true;
    }

    if (
        checkpointVisible &&
        distance >= checkpoints[currentCheckpoint] + 100
    ) {
        checkpointVisible = false;
        currentCheckpoint++;
    }
}

// ===== KRESLEN√ç =====
function drawRoad() {
    ctx.fillStyle = "#222";
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    for (let y = 0; y < canvas.height; y += 40) {
        const p = y / canvas.height;
        const c = curve * 200 * p;
        const center = canvas.width / 2 + c;
        const w = roadWidth * (0.5 + p);

        ctx.fillStyle = "#555";
        ctx.fillRect(center - w / 2, y, w, 40);
    }
}

// üëá CHECKPOINT PRUH
function drawCheckpoint() {
    if (!checkpointVisible) return;

    const p = 0.8;
    const c = curve * 200 * p;
    const center = canvas.width / 2 + c;
    const w = roadWidth * (0.5 + p);

    ctx.fillStyle = "#00ffcc";
    ctx.fillRect(center - w / 2, 300, w, 10);
}

function drawCar() {
    ctx.fillStyle = "red";
    ctx.fillRect(carX - 15, carY - 30, 30, 60);
}

// HUD
function drawHUD() {
    ctx.fillStyle = "white";
    ctx.font = "20px Arial";
    ctx.fillText(
        "Vzd√°lenost: " + Math.floor(distance) + " m",
        20, 30
    );
    ctx.fillText(
        "Rychlost: " + Math.floor(speed * SPEED_MULTIPLIER) + " km/h",
        20, 55
    );

    if (currentCheckpoint < checkpoints.length) {
        function drawCheckpoint() {
    if (!checkpointVisible) return;

    const p = 0.9;                 // bl√≠≈æ k autu
    const c = curve * 200 * p;
    const center = canvas.width / 2 + c;
    const w = roadWidth * (0.5 + p);

    ctx.fillStyle = "#00ffcc";
    ctx.fillRect(
        center - w / 2,
        320,                        // n√≠≈æ na obrazovce
        w,
        30                          // üëà VƒöT≈†√ç V√ù≈†KA PRUHU
    );

    // svƒõtl√Ω okraj (voliteln√©)
    ctx.strokeStyle = "#ffffff";
    ctx.lineWidth = 3;
    ctx.strokeRect(center - w / 2, 320, w, 30);
}

        );
    }
}

function drawGameOver() {
    ctx.fillStyle = "rgba(0,0,0,0.7)";
    ctx.fillRect(0, 0, canvas.width, canvas.height);
    ctx.fillStyle = "white";
    ctx.font = "40px Arial";
    ctx.fillText("GAME OVER", 260, 250);
    ctx.font = "20px Arial";
    ctx.fillText("Stiskni R pro restart", 285, 290);
}

// ===== LOOP =====
function loop() {
    update();
    drawRoad();
    drawCheckpoint(); // üëà checkpoint pruh
    drawCar();
    drawHUD();
    if (gameOver) drawGameOver();
    requestAnimationFrame(loop);
}

// ===== START =====
resetGame();
loop();
</script>
</body>
</html>




